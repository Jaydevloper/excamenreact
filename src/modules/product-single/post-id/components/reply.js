import { useEffect, useState } from "react";
import { Link, useParams } from "react-router-dom";
import Headers from "../../../../components/headers/headers";
import '../../../home/site-main.scss';
import '../../../../assets/scss/container.scss'
import { useSelector } from "react-redux";
import Footer from "../../../../components/footer/footer";
function Reply (){
    const posts = useSelector(state => state.posts.posts)
    const [current,setCurrent] = useState([])
    const [plus,setPlus] = useState(0)
    const [share,setShare] = useState(0)
    const param = useParams()
    useEffect(() => {
        (async function(){
          let res = await fetch(`https://n36-blog.herokuapp.com/posts/${param.id}`,{
              method:"GET",
              headers:{'Content-Type': 'application/json'}
          })
          let data = await res.json()
          setCurrent(data)
      })()
      },[param.id])
      let index = posts.data.findIndex(el => +el.id === +param.id)
     // eslint-disable-next-line
    return  (
        <>
        <Headers/>
        <main className="site-main">
            <div className="site-main__wrraper container">
                <div>
        
                <div className="site-main__like" onClick={()=>setPlus(plus+1)}>
                <svg width="18" height="20" viewBox="0 0 18 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M16.1532 7.63418C15.2358 7.00672 14.6605 6.16776 14.2005 4.87588C14.0295 4.39565 13.6029 4.08513 13.1137 4.08513C12.5878 4.08513 12.1069 4.42426 11.7945 5.01539C11.6191 5.34197 11.5113 5.70055 11.4775 6.06972C11.1535 5.47891 10.4952 5.35322 10.1831 5.77335C10.1831 5.77335 7.61605 3.82187 6.74044 3.20053C5.57682 2.37571 4.03551 3.28924 4.07408 4.23268C2.60477 3.43614 0.991771 4.84245 1.48872 6.31626C0.920411 6.21212 -0.533151 7.71872 0.994985 8.87591C-0.0635238 8.98456 -0.474648 10.6419 0.755511 11.3963C0.755511 11.3963 0.761297 11.6255 0.77769 11.738C-0.0329869 11.9843 -0.312642 13.5169 0.471356 14.0007C0.471356 14.0007 6.12552 17.6111 8.07186 18.6973C9.1294 19.2874 10.9504 19.5192 12.5727 18.9923C14.1481 18.829 15.4846 17.9939 16.5586 16.5057C19.5142 12.4098 17.1728 8.33171 16.1532 7.63418ZM15.807 16.1064C14.5762 17.8358 12.8086 18.0152 11.456 18.0152C9.24801 18.0152 7.89924 16.9566 7.89924 16.9566L1.83941 12.432C0.692187 11.64 1.38297 10.378 2.18786 10.4012L7.00853 13.686L7.60191 13.7229C7.60191 13.7229 3.29619 10.6319 1.9021 9.54387C1.0882 8.9087 1.35564 7.69557 2.40933 7.45449L8.4383 11.7824L9.03104 11.8194L2.59095 6.82479C1.23028 5.83024 2.59577 3.95495 3.91497 4.90996C5.43635 6.01122 10.0134 9.50176 10.0134 9.50176L10.6067 9.53904L4.58132 4.54801C4.52924 3.77784 5.55368 3.10827 6.37271 3.72094C8.01978 4.95303 12.9636 8.64544 12.9636 8.64544C12.8363 8.28896 12.7726 8.02087 12.7726 8.02087C12.7726 8.02087 11.8334 6.45931 12.3422 5.32237C12.789 4.32525 13.6929 4.48726 13.8752 5.0231C14.3596 6.44966 14.8614 7.29634 15.8652 8.00994C17.1471 8.92123 18.458 12.3832 15.807 16.1064Z" fill="black"/>
                <path d="M13.5129 0.285762L10.7453 0L11.6897 3.94088L13.5129 0.285762Z" fill="black"/>
                <path d="M15.8029 1.04919L14.3965 4.32565L17.6769 3.44683L15.8029 1.04919Z" fill="black"/>
                <path d="M8.07092 0.497925L6.07477 2.14789L8.94975 4.02125L8.07092 0.497925Z" fill="black"/>
                </svg>
                <p className="site-main__plus">{plus}</p>
                </div>
                <div className="site-main__like" onClick={()=>setShare(share+1)}>
                <svg width="18" height="20" viewBox="0 0 18 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M14.9469 13.4625C14.4793 13.4626 14.0179 13.5702 13.5985 13.7771C13.1791 13.984 12.8129 14.2846 12.5283 14.6556L5.94318 10.9182C6.16444 10.2762 6.16444 9.57859 5.94318 8.93659L12.5283 5.19917C12.9879 5.79553 13.6519 6.20082 14.3924 6.33707C15.1329 6.47332 15.8976 6.33089 16.5395 5.93719C17.1813 5.54349 17.6548 4.92634 17.869 4.20449C18.0831 3.48264 18.0227 2.7071 17.6994 2.02709C17.3761 1.34709 16.8128 0.810672 16.1177 0.521062C15.4227 0.231451 14.6452 0.20911 13.9347 0.458339C13.2242 0.707567 12.6309 1.21075 12.2691 1.87107C11.9073 2.53139 11.8025 3.30219 11.9749 4.03515L5.27757 7.83629C4.85848 7.39046 4.31511 7.08085 3.71792 6.9476C3.12073 6.81435 2.49727 6.86362 1.92842 7.08902C1.35957 7.31441 0.871573 7.70553 0.527713 8.21164C0.183853 8.71775 0 9.31551 0 9.92739C0 10.5393 0.183853 11.137 0.527713 11.6431C0.871573 12.1493 1.35957 12.5404 1.92842 12.7658C2.49727 12.9912 3.12073 13.0404 3.71792 12.9072C4.31511 12.7739 4.85848 12.4643 5.27757 12.0185L11.9749 15.8197C11.8305 16.4367 11.8817 17.0834 12.1214 17.67C12.3612 18.2566 12.7775 18.7541 13.3127 19.0934C13.8479 19.4327 14.4754 19.5971 15.1082 19.5637C15.741 19.5303 16.3478 19.3008 16.8442 18.907C17.3407 18.5132 17.7024 17.9747 17.879 17.3661C18.0556 16.7575 18.0385 16.109 17.83 15.5106C17.6214 14.9122 17.2318 14.3936 16.7152 14.0266C16.1986 13.6596 15.5806 13.4624 14.9469 13.4625ZM14.9469 1.57165C15.2965 1.57165 15.6383 1.67532 15.9289 1.86954C16.2196 2.06376 16.4462 2.33981 16.5799 2.66279C16.7137 2.98577 16.7487 3.34117 16.6805 3.68404C16.6123 4.02692 16.444 4.34187 16.1968 4.58906C15.9496 4.83626 15.6346 5.00461 15.2918 5.07281C14.9489 5.14101 14.5935 5.10601 14.2705 4.97222C13.9475 4.83844 13.6715 4.61189 13.4773 4.32121C13.283 4.03054 13.1794 3.6888 13.1794 3.33921C13.1799 2.87058 13.3663 2.4213 13.6977 2.08993C14.029 1.75856 14.4783 1.57217 14.9469 1.57165ZM3.05607 11.695C2.70648 11.695 2.36474 11.5913 2.07406 11.3971C1.78339 11.2028 1.55684 10.9268 1.42306 10.6038C1.28927 10.2808 1.25427 9.92543 1.32247 9.58256C1.39067 9.23968 1.55902 8.92473 1.80621 8.67754C2.05341 8.43034 2.36836 8.26199 2.71123 8.19379C3.05411 8.12559 3.40951 8.16059 3.73248 8.29438C4.05546 8.42816 4.33152 8.65471 4.52574 8.94539C4.71996 9.23606 4.82363 9.5778 4.82363 9.92739C4.82311 10.396 4.63672 10.8453 4.30535 11.1767C3.97398 11.508 3.52469 11.6944 3.05607 11.695ZM14.9469 18.2831C14.5973 18.2831 14.2556 18.1795 13.9649 17.9852C13.6743 17.791 13.4477 17.515 13.3139 17.192C13.1801 16.869 13.1451 16.5136 13.2133 16.1707C13.2815 15.8279 13.4499 15.5129 13.6971 15.2657C13.9443 15.0185 14.2592 14.8502 14.6021 14.782C14.945 14.7138 15.3004 14.7488 15.6233 14.8826C15.9463 15.0163 16.2224 15.2429 16.4166 15.5336C16.6108 15.8242 16.7145 16.166 16.7145 16.5156C16.714 16.9842 16.5276 17.4335 16.1962 17.7648C15.8648 18.0962 15.4156 18.2826 14.9469 18.2831Z" fill="black"/>
                </svg>
                <p className="site-main__plus">{share}</p>
                </div>
                
                </div>
                <div className="right-content">
                      <h2 className="site-main__head">
                        Recent Posts
                      </h2>
                    <ul className="site-main__list">
                        {
                           <li className="site-main__item" id={current.id}>
                              <div className="site-main__item-wrraper">
                                  <p className="site-main__iteam-page">{current.title}</p>
                                  <p className="site-main__iteam-page">{current.category_name}</p>
                              </div>
                              <img src={current.main_image_url} alt="..." width={352} height={736} />
                              <p className="site-main__page">
                              {current.body}
                              </p>
                              <time className="site-main__time">{`${new Date(current.created_at).getFullYear()}/${new Date(current.created_at).getMonth()+1}/${new Date(current.created_at).getMinutes()}`} Date</time>
                          </li>
                        }
                        {
                           posts.data && posts.data.slice(index+1,posts.length)?.map(el => {
                                return(
                                    <li className="site-main__item" key={el.user_id} id={el.id}>
                                    <div className="site-main__item-wrraper">
                                        <p className="site-main__iteam-page">{el.title}</p>
                                        <p className="site-main__iteam-page">{el.category_name}</p>
                                    </div>
                                    <p className="site-main__page">
                                    {el.title}
                                    </p>
                                    <time className="site-main__time">{new Date (el.created_time).getMinutes()} minutes read</time>
                                    <Link className="site-main__link" to={`/reply/${el.id}`}></Link>
                                </li>
                                )
                            })
                        }
                        
                    </ul>
                </div>
            </div>
        </main>
        <Footer/>
        </>
    )
}
export default Reply